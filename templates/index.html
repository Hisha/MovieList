<!DOCTYPE html>
<html>
<head>
    <title>Movie List</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/alpinejs" defer></script>
</head>
<body class="bg-gray-900 text-white">
    <div class="container mx-auto p-6">
        <h1 class="text-3xl font-bold mb-6">My Movie Collection</h1>

        <form method="get" class="flex gap-4 mb-6">
            <input type="text" name="search" value="{{ search_query or '' }}" placeholder="Search by name" class="px-4 py-2 rounded text-black">
            <select name="genre" class="px-4 py-2 text-black">
                <option value="">All Genres</option>
                {% for g in genres %}
                    <option value="{{ g }}" {% if selected_genre == g %}selected{% endif %}>{{ g }}</option>
                {% endfor %}
            </select>
            <select name="actor" class="px-4 py-2 text-black">
                <option value="">All Actors</option>
                {% for a in actors %}
                    <option value="{{ a }}" {% if selected_actor == a %}selected{% endif %}>{{ a }}</option>
                {% endfor %}
            </select>
            <button type="submit" class="bg-blue-600 px-4 py-2 rounded">Filter</button>
        </form>

        <form method="post" action="/rescan" class="mb-6">
            <button type="submit" class="bg-green-600 px-4 py-2 rounded">Rescan Movies</button>
        </form>

        <div class="grid grid-cols-6 gap-4">
            {% for movie in movies %}
                <div x-data="{ open: false }">
                    <img src="/posters/{{ movie[1] }}/poster.jpg" alt="{{ movie[0] }}" class="w-full h-auto cursor-pointer" @click="open = true">
                    
                    <!-- Modal -->
                    <div x-show="open" class="fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center" style="display: none;">
                        <div class="bg-gray-800 p-6 rounded max-w-lg w-full">
                            <h2 class="text-2xl font-bold mb-2">{{ movie[0] }}</h2>
                            <p><strong>Genres:</strong> {{ movie[2] }}</p>
                            <p><strong>Actors:</strong> {{ movie[3] }}</p>
                            <p class="mt-2">{{ movie[4] }}</p>
                            <button @click="open = false" class="mt-4 bg-red-600 px-4 py-2 rounded">Close</button>
                        </div>
                    </div>
                </div>
            {% endfor %}
        </div>
    </div>
</body>
</html>
